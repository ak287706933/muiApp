<!DOCTYPE html>
<html>
	<head>
	<meta charset="UTF-8">
	<meta name="Generator" content="">
	<meta name="Author" content="">
	<meta name="Keywords" content="">
	<meta name="Description" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
	<meta content="telephone=no" name="format-detection">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<link rel="stylesheet" type="text/css" href="public/css/base.css">
	<link rel="stylesheet" type="text/css" href="public/css/index.css">
	<link rel="stylesheet" type="text/css" href="public/css/font.css">
	<link rel="stylesheet" type="text/css" href="public/css/iconfont.css">
	<script type="text/javascript" src="public/js/jquery-2.1.3.min.js" ></script>
	<script type="text/javascript" src="public/js/layer_mobile/layer.js" ></script>
	<style type="text/css">
		.layui-m-layercont{padding:0}
	</style>
	<title>患病信息列表页</title>
	<body>
		<!--header-->
		<header class="header_fixed">
			<a href="javascript:history.back(-1)" class="return_pre iconfont">&#xe660;</a>
			<div class="header_title">患病信息</div>
			<a href="add-info.html" class="add_record iconfont">&#xe722;</a>
		</header>
		<div class="header_fixed_div"></div>
		<!--header end-->
		<!--content-->
		<div class="content illness_list_content">
			<div class="container">
				<!--病史一-->
				<section class="illness_list" id="info_first">
					<header><a href="javascript:void(0)" class="see_more iconfont icon-arrow-down"></a>病史一(糖尿病)</header>
					<div class="list_show">
						<div class="list_show_form">
							<div class="info_list illness_name">
								<div class="info_list_main">
									<div class="left">所患疾病</div>
									<div class="right" id="illness_name">糖尿病</div>
								</div>
							</div>
							<div class="info_list illness_category">
								<div class="info_list_main">
									<div class="left">疾病类型</div>
									<div class="right" id="illness_category">糖尿病I型</div>
								</div>
							</div>
							<div class="info_list illness_time">
								<div class="info_list_main">
									<div class="left">诊断时间</div>
									<div class="right">2017-09-20</div>
								</div>
							</div>
							<div class="info_list illness_statue">
								<div class="info_list_main">
									<div class="left">治疗状态</div>
									<div class="right" id="illness_statue">治疗中</div>
								</div>
							</div>
							<div class="info_list illness_basic">
								<div class="info_list_main">
									<div class="left">基本症状</div>
									<div class="right" id="illness_basic">
										<ul class="illness_label">
											<li>多尿</li><li>乏力</li><li>消瘦</li><li>自盗自汗</li>
										</ul>
									</div>
								</div>
							</div>
							<div class="info_list illness_link" >
								<div class="info_list_main">
									<div class="left">并发症</div>
									<div class="right" id="illness_link">
										<ul class="illness_label">
											<li>糖尿病足</li><li>糖尿病肾病</li><li>糖尿病性视网膜病变</li>
										</ul>
									</div>
								</div>
							</div>
							<div class="ill_reason">
								<div class="info_list_main">
									<div class="left">病因</div>
									<div class="right">
										<div class="ill_reason_box">
											<div class="microphone_input">
												<i class="iconfont">&#xe6e0;</i>
												<p>语音输入</p>
											</div>
											<div class="input_reason">
												<textarea class="reason_box" class="normal_gray" value="无"></textarea>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="list_deal_btn">
							<button>删除本条记录</button>
						</div>	
					</div>
						
				</section>
				<!--病史一 end-->
				<!--病史二-->
				<section class="illness_list" id="info_second">
					<header><a href="javascript:void(0)" class="see_more iconfont icon-arrow-down"></a>病史二(高血压)</header>
					<div class="list_show">
						<div class="list_show_form">
							<div class="info_list illness_name">
								<div class="info_list_main">
									<div class="left">所患疾病</div>
									<div class="right" id='illness_name'>糖尿病</div>
								</div>
							</div>
							<div class="info_list illness_category">
								<div class="info_list_main">
									<div class="left">疾病类型</div>
									<div class="right" id="illness_category">高血压</div>
								</div>
							</div>
							<div class="info_list illness_time">
								<div class="info_list_main">
									<div class="left">诊断时间</div>
									<div class="right">2017-09-20</div>
								</div>
							</div>
							<div class="info_list illness_statue">
								<div class="info_list_main">
									<div class="left">治疗状态</div>
									<div class="right" class="illness_statue">治疗中</div>
								</div>
							</div>
							<div class="info_list illness_basic">
								<div class="info_list_main">
									<div class="left">基本症状</div>
									<div class="right" id="illness_basic">
										<ul class="illness_label">
											<li>多尿</li><li>乏力</li><li>消瘦</li><li>自盗自汗</li>
										</ul>
									</div>
								</div>
							</div>
							<div class="info_list illness_link">
								<div class="info_list_main">
									<div class="left">并发症</div>
									<div class="right" id="illness_link">
										<ul class="illness_label">
											<li>糖尿病足</li><li>糖尿病肾病</li><li>糖尿病性视网膜病变</li>
										</ul>
									</div>
								</div>
							</div>
							<div class="ill_reason">
								<div class="info_list_main">
									<div class="left">病因</div>
									<div class="right">
										<div class="ill_reason_box">
											<div class="microphone_input">
												<i class="iconfont">&#xe6e0;</i>
												<p>语音输入</p>
											</div>
											<div class="input_reason">
												<textarea class="reason_box" class="normal_gray" value="无"></textarea>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="list_deal_btn">
							<button>删除本条记录</button>
						</div>	
					</div>
				</section>
				<!--病史二 end-->
			</div>
		</div>
		<!--content end-->
		<div class="microphone_section ">
			<!--开始说话前-->
			<div class="before_speak" >
				<div class="before_speak_box" >
					<p>按住说话</p>
					<a href="javascript:void(0)" class="iconfont hide_microphone">&#xe600;</a>
					<a href="javascript:void(0)" class="iconfont deal_microphone">&#xe6e0;</a>
				</div>
			</div>
			<!--开始说话前 end-->
			<!--说话中-->
			<div class="speaking" style="display: none;">
				<div class="speaking_box">
					<p>请说话</p>
					<div class="deal_shadow" >
						<a href="javascript:void(0)" class="iconfont deal_microphone">&#xe6e0;</a>
					</div>
				</div>
			</div>
			<!--说话中 end-->
			<!--说话完成后，待确认-->
			<div class="ensure_speak" style="display: none;">
				<div class="ensure_box">
					<div class="speaking_result">这里是语音转换成文字后的区域</div>
					<a href="javascript:void(0)" class="word_deal result_cancle">取消</a>
					<a href="javascript:void(0)" class="iconfont deal_microphone">&#xe6e0;</a>
					<a href="javascript：void(0)" class="word_deal result_ensure">确定</a>
				</div>
				
			</div>
			<!--说话完成后，待确认 end-->
		</div>
		<div class="microphone_section_kong"></div>
	</body>
	<script type="text/javascript">
		$(function(){
			//语音输入
			$('.microphone_input').click(function(){
				$(".microphone_section").toggleClass('animate')
			});
			$('a.hide_microphone').click(function(){
				$(".microphone_section").removeClass('animate');
			})
			//展开病例
			$('header a.see_more').click(function(){
				var $this = $(this);
				$this.parent('header').siblings('.list_show').slideToggle(500);
				if( $this.hasClass('icon-arrow-down') ){
					$this.removeClass('icon-arrow-down').addClass('icon-arrow-up')
				}else{
					$this.removeClass('icon-arrow-up').addClass('icon-arrow-down')
				}
			});
			//病种选择
			$('.illness_name').click(function(){
				var parent = $(this).parents('.illness_list').attr('id')
				disease( parent );
			});
			
			//病症选择
			$(".illness_category").click(function(){
				var parent = $(this).parents('.illness_list').attr('id')
				disease(parent);
			})
			
			//并发症选择
			$('.illness_link').click(function(){
				var parent = $(this).parents('.illness_list').attr('id')
				complications(parent)
			});
			
			//基本病症选择
			$('.illness_basic').click(function(){
				var parent = $(this).parents('.illness_list').attr('id')
				symptoms(parent)
			})
			//治疗状态的选择
			$('.illness_statue').click(function(){
				var parent = $(this).parents('.illness_list').attr('id')
				mendCondition( parent )
			})
			//病种选择
			function disease( target ){
				layer.open({
					shadeClose: true,
					title : [
								'病种选择',
								'background:#3C7857;color:#fff;height:3.6rem;line-height:3.6rem;font-size:1.4rem'
							],
					content : `<div class="list_box disease_box">
									<div class='father_list_box'>
										<ul class="father_list">
											<li val="f0" class="on">糖尿病</li>
											<li val="f1">高血压</li>
											<li val="f2">血脂异常</li>
											<li val="f3">动脉硬化</li>
											<li val="f4">心率衰竭</li>
											<li val="f5">痛风</li>
											<li val="f6">肺结核</li>
										</ul>
									</div>
									<div class="child_list_box">
										<ul class="child_list">
											<li val='c0'>糖尿病I型</li>
											<li val='c0' class="on">糖尿病II型</li>
											<li val='c0'>妊娠糖尿病</li>
											<li val='c0'>继发性糖尿病</li>
										</ul>
									</div>
									<button class="next_step_btn">下一步</buttom>
								</div>
							  `
				});
				//下一步
				$('.next_step_btn').click(function(){
					
					var ill_name = $('ul.father_list li.on').html();
					var ill_categery = $('ul.child_list li.on').html();
					$('#'+target).children().find('#illness_name').html( ill_name );
					$('#'+target).children().find('#illness_category').html( ill_categery );
					symptoms();
					
				});
				//子病种选择()
				$('.child_list li,.father_list li').click(function(){
					$(this).addClass('on').siblings().removeClass('on')
				});
			}
			//基本病症选择
			function symptoms(target){
				layer.open({
					shadeClose: true,
					title : [
								'基本病症选择',
								'background:#FF9800;color:#fff;height:3.6rem;line-height:3.6rem;font-size:1.4rem'
							],
					content : `<div class="list_box symptoms_box">
									<ul class="symptoms_list">
										<li val="s0" class="on">多尿</li>
										<li val="s1">乏力</li>
										<li val="s2">消瘦</li>
										<li val="s3">自盗自汗</li>
										<li val="s4">口干</li>
										<li val="s5">头晕</li>
										<li val="s6">消瘦</li>
									</ul>
									<div class='btn_set'>
										<button class="pre_step_btn">上一步</buttom>
										<button class="next_step_btn">下一步</buttom>
									</div>
								</div>
							  `
				});
				//上一步
				$('button.pre_step_btn').click(function(){
					disease();
				});
				//下一步
				$('button.next_step_btn').click(function(){
					var result = selectMore( 'symptoms' );
					$('#'+target).children().find('#illness_basic').html( result );
					complications();
				});
				//病症选择()
				$('ul.symptoms_list li').click(function(){
					$(this).toggleClass('on')
				});
			}
			
			//并发症选择
			function complications(target){
				layer.open({
					shadeClose: false,
					title : [
								'并发症选择',
								'background:#FF9800;color:#fff;height:3.6rem;line-height:3.6rem;font-size:1.4rem'
							],
					content : `<div class="complications">
									<ul class="complications_list">
										<li val="c0" class="on">糖尿病足</li>
										<li val="c1">糖尿病肾病</li>
										<li val="c2">糖尿病性视网膜病变</li>
										<li val="c3">糖尿病并发神经末梢感觉障碍</li>
										<li val="c4">糖尿病合并感染</li>
										<li val="c5">头晕</li>
										<li val="c6">消瘦</li>
									</ul>
									<div class='btn_set'>
										<button class="pre_step_btn">上一步</buttom>
										<button class="save_btn">保存</buttom>
									</div>
								</div>
							  `
				});
				//上一步
				$('button.pre_step_btn').click(function(){
					symptoms();
				});
				//并发症选择
				$("ul.complications_list li").click(function(){
					$(this).toggleClass('on')
				});
				
				//保存按钮
				$('.btn_set .save_btn').click(function(){
					var complications = [];
					$('ul.complications_list li.on').each(function(){
						complications.push( $(this).html() );
					})
					
					var $UL ='';
					if( complications[0] != undefined ){
						var $LI = '';
						for( var i = 0 ; i < complications.length ; i++ ){
							$LI += '<li>'+complications[i]+'</li>';
						}
						$UL = '<ul class="illness_label">'+$LI+'</ul>';
					}else{
						$UL = '无';
					}
					$('#'+target).children().find("#illness_link").html( $UL );
					layer.closeAll();
				})
			}
			
			//治疗状态选择
			function mendCondition(target){
				layer.open({
					shadeClose: true,
					title : [
								'治疗状态选择',
								'background:#3C7857;color:#fff;height:3.6rem;line-height:3.6rem;font-size:1.4rem'
							],
					content : `<div class="condition_box">
									<ul class="condition_list">
										<li val="co0">治疗中</li>
										<li val="co1" class="on">已痊愈</li>
										<li val="co2">未治疗</li>
									</ul>
									<button class="save">保存</buttom>
								</div>
							  `
				});
				//选择治疗状态
				$('ul.condition_list li').click(function(){
					$(this).addClass('on').siblings().removeClass('on')
				})
				
				$('button.save').click(function(){
					var state = $('ul.condition_list li.on').html();
					console.log( state )
					if( state != undefined ){
						console.log( 'fadads' )
						$('#'+target).children().find('#illness_statue').html( state )
						 layer.closeAll();
					}
				})
			}
			
			//多选保存选项
			function selectMore( name ){
				var options = [];
				if( options[0] != undefined ){}
					$('ul.'+name+'_list li.on').each(function(){
						options.push( $(this).html() );
					})
					var $UL ='';
					if( options[0] != undefined ){
						var $LI = '';
						for( var i = 0 ; i < options.length ; i++ ){
							$LI += '<li>'+options[i]+'</li>';
						}
						$UL = '<ul class="illness_label">'+$LI+'</ul>';
					}
					return $UL ;
			}
			
			
			var memcardno;//会员卡号
			var compid;//企业编码
			var urlname;//记录具体要跳转的具体详细页面
			var valname;//采集的健康类型
			var cname;
			var collecttype;//获取大表格类型
			//接收页面传过来的会员号
		    function UrlSearch(){
		       var name,value; 
		       var str=location.href;
		       var num=str.indexOf("?");
		       str=str.substr(num+1);
		       var arr=str.split("&");
		       for(var i=0;i < arr.length;i++){ 
		         num=arr[i].indexOf("="); 
		          if(num>0){ 
		          name=arr[i].substring(0,num);
		          value=arr[i].substr(num+1);
		          this[name]=value;
		         } 
		       } 
		     } 
		     var Request=new UrlSearch(); 
		     memcardno=Request.memcardno;
		     compid=Request.compid;
		     //mui.toast(compid);
		     
		    //获取客户信息
			$.ajax({
				url:"getDisease.do?memcardno="+memcardno,
				type:"get",
				dataType:"json",
				success:function(data){
					 var json = eval(data);
					 alert(json);
				},
				error:function(data){
					alert('失败' + data);
				}
			});
			
		})
		
		
			
	</script>
</html>
