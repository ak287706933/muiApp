<!DOCTYPE html>
<html>
	<head>
	<meta charset="UTF-8">
	<meta name="Generator" content="">
	<meta name="Author" content="">
	<meta name="Keywords" content="">
	<meta name="Description" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
	<meta content="telephone=no" name="format-detection">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<link rel="stylesheet" type="text/css" href="css/base.css">
	<link rel="stylesheet" type="text/css" href="css/index.css">
	<script type="text/javascript" src="js/jquery-2.1.3.min.js" ></script>
	<script type="text/javascript" src="js/layer_mobile/layer.js" ></script>
	<script type="text/javascript" src="js/common.js" ></script>
	<!--  
	<link rel="stylesheet" type="text/css" href="css/mui.picker.min.css"/>
	<link rel="stylesheet" href="css/mui.min.css">
	<script src="js/mui.min.js"></script>
	<script src="js/mui.picker.min.js" type="text/javascript" charset="utf-8"></script>-->
	<style type="text/css">
		.layui-m-layercont{padding:0}
	</style>
	<title>新增成员</title>
	<body>
<!--alert-->
		<div class="alert">
			<div class="alert_content">
				<!--所患疾病-->
				<div class="alert_illness_category" id="show1">
				
				</div>
				<!--所患疾病 end-->
				<!--治疗状态-->
				<div class="alert_illness_statue">
					<div class="section_title">治疗状态</div>
					<div class="condition_box">
						<ul class="condition_list">
							<li val="co0">治疗中</li>
							<li val="co1">已痊愈</li>
							<li val="co2">未治疗</li>
						</ul>
						<button class="save">保存</buttom>
					</div>
				</div>
				<!--治疗状态 end-->
				<!--基本病症-->
				<div class="alert_illness_basic" id="show2">
					
				</div>
				<!--基本病症 end-->
				<!--并发症-->
				<div class="alert_illness_link" id="show3">
					
				</div>
				<!--并发症-->
				<div class="alert_notice">
					<div class="section_title">选择提醒</div>
					<div class="notice_tips">
						请选择病种!
					</div>
				</div>
			</div>
		</div>
		<!--alert-->
		<!--header-->
		<header class="header_fixed">
			<a href="javascript:history.back(-1)" class="return_pre"></a>
			<div class="header_title">基本信息</div>
			<a class="add_record add_finish">&nbsp;</a>
		</header>
		<div class="header_fixed_div"></div>
		<!--header end-->
		<!--content-->
		<div class="content medicine_record_content">
			<div class="member_details_list">
				<div class="add_member_first">
					<section class="member_detail_info">
						<div class="info_section">
							<div class="list_group">
								<div class="container">
									<div class="left">会员卡号</div>
									<div class="right info_input"><input class="form_control"  id="MEMCARDNO"/><div class="input_result">未填写</div></div>
								</div>
							</div>
							<div class="list_group">
								<div class="container">
									<div class="left">姓名</div>
									<div class="right info_input"><input class="form_control"  id="CARDHOLDER"/><div class="input_result">未填写</div></div>
								</div>
							</div>
							<div class="list_group">
								<div class="container">
									<div class="left">性别</div>
									<div class="right user_sex" id="SEX">未选择</div>
								</div>
							</div>
							<div class="list_group">
								<div class="container">
									<div class="left">年龄</div>
									<div class="right info_input" ><input type="text" class="form_control" id="AGE"/><span class="unit">岁</span><div class="input_result">30</div></div>
								</div>
							</div>
							<div class="list_group">
								<div class="container">
									<div class="left">出生日期</div>
									<div class="right" class="birth_time" id="BIRTHDAY">未选择</div>
								</div>
							</div>
							<div class="list_group">
								<div class="container">
									<div class="left">身份证号</div>
									<div class="right info_input"><input type="number"  id="IDCARD" class="form_control"/><div class="input_result">未填写</div></div>
								</div>
							</div>
							<div class="list_group">
								<div class="container">
									<div class="left">家庭身份</div>
									<div class="right family_identity"  id="FAMILY">未选择</div>
								</div>
							</div>
						</div>
						<div class="info_section">
							<div class="list_group">
								<div class="container">
									<div class="left">制卡机构</div>
									<div class="right" id="MODBUSNO">海典大药房</div>
								</div>
							</div>
							<div class="list_group">
								<div class="container">
									<div class="left">医保信息</div>
									<div class="right safeguard_info" id="MEDICAL">未选择</div>
								</div>
							</div>
							<div class="list_group">
								<div class="container">
									<div class="left">档案类型</div>
									<div class="right archives_sort" id="FILETYPE">未选择</div>
								</div>
							</div>
							<div class="list_group">
								<div class="container">
									<div class="left">档案号</div>
									<div class="right" id="BILLNO"></div>
								</div>
							</div>
						</div>
						<div class="info_section">
							<div class="list_group">
								<div class="container">
									<div class="left">手机号码</div>
									<div class="right info_input"><input id="MOBILE" type="tel" class="form_control"/><div class="input_result">未填写</div></div>
								</div>
							</div>
							<div class="list_group">
								<div class="container">
									<div class="left">家庭住址</div>
									<div class="right info_input"><input id="CARDADDRESS" type="text" class="form_control"/><div class="input_result">未填写</div></div>
								</div>
							</div>
						</div>
						<div class="info_section">
							<div class="list_group">
								<div class="container">
									<div class="left">紧急联系人</div>
									<div class="right info_input"><input  id="EMECONTACT" type="text" class="form_control"/><div class="input_result">未填写</div></div>
								</div>
							</div>
							<div class="list_group">
								<div class="container">
									<div class="left">联系号码</div>
									<div class="right info_input"><input id="TEL" type="tel" class="form_control"/><div class="input_result">未填写</div></div>
								</div>
							</div>
						</div>
					</section>
					<div class="fixed_btn">
						<button class="next_btn" onclick="tabShow('sty','add_member_second')">下一步</button>
					</div>
				</div>
				<div class="add_member_second">
					<div class="health_info">
						<section class="member_details_list">
							<div class="member_details_header">
								<div class="container">体测类</div>
							</div>
							<div class="info_list_show">
								<div class="info_section">
									<div class="list_group">
										<div class="container">
											<div class="left">身高</div>
											<div class="right info_input"><input id="HEIGHT"  type="text" class="form_control"/><span class="unit">CM</span></div>
										</div>
									</div>
									<div class="list_group">
										<div class="container">
											<div class="left">体重</div>
											<div class="right info_input"><input id="WEIGHT"  type="text" class="form_control"/><span class="unit">KG</span></div>
										</div>
									</div>
									<div class="list_group">
										<div class="container">
											<div class="left">体温</div>
											<div class="right info_input"><input id="TEMPERATURE"  type="text" class="form_control"/><span class="unit">℃</span></div>
										</div>
									</div>
									<div class="list_group">
										<div class="container">
											<div class="left">步数</div>
											<div class="right info_input"><input id="STEPS"  type="text" class="form_control"/><span class="unit">步</span></div>
										</div>
									</div>
									<div class="list_group">
										<div class="container">
											<div class="left">血氧</div>
											<div class="right info_input"><input id="OXYGEN"  type="text" class="form_control"/><span class="unit">%bmp</span></div>
										</div>
									</div>
								</div>
							</div>
						</section>
						<section class="member_details_list">
							<div class="member_details_header">
								<div class="container">血液类</div>
							</div>
							<div class="info_list_show">
								<div class="info_section">
									<div class="list_group">
										<div class="container">
											<div class="left">收缩压</div>
											<div class="right info_input"><input id="SYSTOLIC"  type="text" class="form_control"/><span class="unit">mm/Hg</span></div>
										</div>
									</div>
									<div class="list_group">
										<div class="container">
											<div class="left">舒张压</div>
											<div class="right info_input"><input  id="DIASTOLIC" type="text" class="form_control"/><span class="unit">mm/Hg</span></div>
										</div>
									</div>
									<div class="list_group">
										<div class="container">
											<div class="left">心率</div>
											<div class="right info_input"><input id="HEARTRATE"  type="text" class="form_control"/><span class="unit">bmp</span></div>
										</div>
									</div>
								</div>
							</div>
						</section>
						<section class="member_details_list">
							<div class="member_details_header">
								<div class="container">血糖类</div>
							</div>
							<div class="info_list_show">
								<div class="info_section">
									<div class="list_group">
										<div class="container">
											<div class="left">初诊血糖</div>
											<div class="right info_input"><input id="BLOODSUGAR8"  type="text" class="form_control"/><span class="unit">mmol/L</span></div>
										</div>
									</div>
									<div class="list_group">
										<div class="container">
											<div class="left">早餐前血糖</div>
											<div class="right info_input"><input id="BLOODSUGAR1"  type="text" class="form_control"/><span class="unit">mmol/L</span></div>
										</div>
									</div>
									<div class="list_group">
										<div class="container">
											<div class="left">早餐后血糖</div>
											<div class="right info_input"><input id="BLOODSUGAR2"  type="text" class="form_control"/><span class="unit">mmol/L</span></div>
										</div>
									</div>
									<div class="list_group">
										<div class="container">
											<div class="left">午餐前血糖</div>
											<div class="right info_input"><input id="BLOODSUGAR3"  type="text" class="form_control"/><span class="unit">mmol/L</span></div>
										</div>
									</div>
									<div class="list_group">
										<div class="container">
											<div class="left">午餐后血糖</div>
											<div class="right info_input"><input id="BLOODSUGAR4"  type="text" class="form_control"/><span class="unit">mmol/L</span></div>
										</div>
									</div>
									<div class="list_group">
										<div class="container">
											<div class="left">晚餐前血糖</div>
											<div class="right info_input"><input id="BLOODSUGAR5"  type="text" class="form_control"/><span class="unit">mmol/L</span></div>
										</div>
									</div>
									<div class="list_group">
										<div class="container">
											<div class="left">晚餐后血糖</div>
											<div class="right info_input"><input id="BLOODSUGAR6"  type="text" class="form_control"/><span class="unit">mmol/L</span></div>
										</div>
									</div>
									<div class="list_group">
										<div class="container">
											<div class="left">睡觉前血糖</div>
											<div class="right info_input"><input id="BLOODSUGAR9"  type="text" class="form_control"/><span class="unit">mmol/L</span></div>
										</div>
									</div>
									<div class="list_group">
										<div class="container">
											<div class="left">随机值</div>
											<div class="right info_input"><input id="BLOODSUGAR7"  type="text" class="form_control"/><span class="unit">mmol/L</span></div>
										</div>
									</div>
								</div>
							</div>
						</section>
						<section class="member_details_list">
							<div class="member_details_header">
								<div class="container">血脂类</div>
							</div>
							<div class="info_list_show">
								<div class="info_section">
									<div class="list_group">
										<div class="container">
											<div class="left">糖化血红蛋白</div>
											<div class="right info_input"><input id="GLYCOSYLATED"  type="text" class="form_control"/><span class="unit">mmol/L</span></div>
										</div>
									</div>
									<div class="list_group">
										<div class="container">
											<div class="left">总胆固醇</div>
											<div class="right info_input"><input id="CHOLESTEROL"  type="text" class="form_control"/><span class="unit">mmol/L</span></div>
										</div>
									</div>
									<div class="list_group">
										<div class="container">
											<div class="left">甘油三酯</div>
											<div class="right info_input"><input id="TRIGLYCERIDE"  type="text" class="form_control"/><span class="unit">mmol/L</span></div>
										</div>
									</div>
									<div class="list_group">
										<div class="container">
											<div class="left">高密度脂蛋白</div>
											<div class="right info_input"><input id="HIGHLIPOPROTEIN"  type="text" class="form_control"/><span class="unit">mmol/L</span></div>
										</div>
									</div>
									<div class="list_group">
										<div class="container">
											<div class="left">低密度脂蛋白</div>
											<div class="right info_input"><input id="LOWLIPOPROTEIN"  type="text" class="form_control"/><span class="unit">mmol/L</span></div>
										</div>
									</div>
									<div class="list_group">
										<div class="container">
											<div class="left">同型半胱氨酸</div>
											<div class="right info_input"><input id="HOMOCYSTEINE"  type="text" class="form_control"/><span class="unit">mmol/L</span></div>
										</div>
									</div>
								</div>
							</div>
						</section>
					</div>
					<div class="fixed_btn">
						<div class="btn_set">
							<button  class="next_btn" onclick="tabShow('sty','add_member_first')">上一步</button>
							<button  class="next_btn save_btn" onclick="tabShow('sty','add_member_third')">下一步</button>
						</div>
					</div>
				</div>	
				<div class="add_member_third">
					<!--增加病史-->
				<section class="illness_list add_info_list">
					<header>病史</header>
					<div class="list_show">
						<div class="list_show_form">
							<div class="info_list illness_name">
								<div class="info_list_main">
									<div class="left">所患疾病</div>
									<div class="right" id="illness_name"><input id="diseasename" type="text" placeholder="请选择" class="form_control normal_gray" disabled="disabled"/></div>
								</div>
							</div>
							<div class="info_list illness_category">
								<div class="info_list_main">
									<div class="left">疾病类型</div>
									<div class="right" id="illness_category"><input id="diseasetype"  type="text" placeholder="请选择" class="form_control normal_gray" disabled="disabled"/></div>
								</div>
							</div>
							<div class="info_list illness_time">
								<div class="info_list_main">
									<div class="left">诊断时间</div>
									<div class="right">
									
									<!-- <input type="text" placeholder="请选择" class="form_control normal_gray" disabled="disabled"/> -->
									<input type="button" style="border: none" value="请选择" data-options='{}' id="datePicker"/>
									</div>
									<!-- 
									<script type="text/javascript">
									//记录日期选择
									(function($) {
										$.init();
										var pickBtn = document.querySelector("#datePicker");
										pickBtn.addEventListener("tap",function(){
											var optionsJson = this.getAttribute('data-options') || '{}';
											var options = JSON.parse(optionsJson);
											var picker = new mui.DtPicker({
											　　　　"type":"date"
											　　　});
											picker.show(function(rs) {
												pickBtn.value = rs.text;
												picker.dispose();
											});
										},false);
									})(mui);
									
									</script> -->
									
								</div>
							</div>
							<div class="info_list illness_statue">
								<div class="info_list_main">
									<div class="left">治疗状态</div>
									<div class="right" id="illness_statue"><input  id="tstate"  type="text"  placeholder="请选择" class="form_control normal_gray" disabled="disabled"/></div>
								</div>
							</div>
							<div class="info_list illness_basic">
								<div class="info_list_main">
									<div class="left">基本症状</div>
									<div class="right" id="illness_basic"><input  id="basicsymptom"  type="text" placeholder="请选择" class="form_control normal_gray" disabled="disabled"/></div>
								</div>
							</div>
							<div class="info_list illness_link" >
								<div class="info_list_main">
									<div class="left">并发症</div>
									<div class="right" id="illness_link"><input id="concurrent" type="text"  placeholder="请选择" class="form_control normal_gray" disabled="disabled"/></div>
								</div>
							</div>
							<div class="ill_reason">
								<div class="info_list_main">
									<div class="left">病因</div>
									<div class="right">
										<div class="ill_reason_box">
											<div class="microphone_input">
												<i class="icon_microphone"></i>
												<p>语音输入</p>
											</div>
											<div class="input_reason">
												<textarea class="reason_box" id="pathogeny"  placeholder="请输入" class="normal_gray"></textarea>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</section>
				<!--增加病史 end-->
					<div class="fixed_btn">
						<div class="btn_set">
							<button  class="next_btn" onclick="tabShow('sty','add_member_second')">上一步</button>
							<button  class="next_btn save_btn" onclick="tabShow('sty','add_member_fourth')">下一步</button>
						</div>
					</div>
				</div>
				<div class="add_member_fourth">
					<!--增加用药记录 section-->
					<section class="illness_list add_medicine_record" >
				<div class="list_show_form">
					<div class="info_list">
						<div class="info_list_main">
							<a onclick="clickSearch()">
								<div class="left">商品编码</div>
								<div class="right"><input type="text"  id="warecode"  class="form_control" readonly="readonly"/></div>
							</a>
						</div>
					</div>
					<div class="info_list">
						<div class="info_list_main">
							<div class="left">药品名称</div>
							<div class="right"><input type="text"  class="form_control"  id="warename" readonly="readonly"/></div>
						</div>
					</div>
					<div class="info_list">
						<div class="info_list_main">
							<div class="left">生产企业</div>
							<div class="right"><input type="text"  class="form_control" id="factoryname" readonly="readonly"/></div>
						</div>
					</div>
					<div class="info_list">
						<div class="info_list_main">
							<div class="left">药物规格</div>
							<div class="right"><input type="text"  class="form_control"  id="warespec" readonly="readonly"/></div>
						</div>
					</div>
					<div class="info_list">
						<div class="info_list_main">
							<div class="left">用法用量</div>
							<div class="right"><input type="text"  class="form_control"  id="usage" /></div>
						</div>
					</div>
				</div>
			</section>
					<!--增加病史  section end-->
					<!--增加用药记录 section-->
				<section class="illness_list add_medicine_record" >
				<div class="list_show_form">
					<div class="info_list">
						<div class="info_list_main">
							<div class="left">可用天数</div>
							<div class="right"><input type="text"  class="form_control"  id="availabledays" /><span>天</span></div>
						</div>
					</div>
					<div class="info_list">
						<div class="info_list_main">
							<div class="left">使用状态</div>
							<div class="right" id="using_statue"><input type="text"  class="form_control"  id="stilluse"  readonly="readonly"/></div>
						</div>
					</div>
					<div class="info_list">
						<div class="info_list_main">
							<div class="left">开始时间</div>
							<div class="right" id="start_time">
								<input type="button" style="border: none" value="请选择" data-options='{}' id="datePicker1"/>
							</div>
						</div>
					</div>
					<div class="info_list">
						<div class="info_list_main">
							<div class="left">结束时间</div>
							<div class="right" id="end_time">
								<input type="button" style="border: none" value="请选择" data-options='{}' id="datePicker2"/>
							</div>
						</div>
					</div>
					
				</div>
			</section>
					<!--增加病史  section end-->
					<!--增加用药记录 section-->
					<section class="illness_list add_medicine_remark" >
						<div class="list_show_form">
							<div class="medicine_remark">
								<div class="remark_title">备注</div>
								<div class="microphone_input_box">
									<div class="microphone_label_section">
										<div class="microphone_input">
											<i class="icon_microphone"></i>
											<p>语音输入</p>
										</div>
									</div>
									<div class="input_textarea">
										<textarea class="reason_box" id="notes"  placeholder="请输入" class="normal_gray"></textarea>
									</div>
								</div>
							</div>
						</div>
					</section>
					<!--增加病史  section end-->
					<div class="fixed_btn">
						<div class="btn_set">
							<button  class="next_btn" onclick="tabShow('sty','add_member_third')">上一步</button>
							<button  class="next_btn save_btn" onclick="saveMembers()">保存</button>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="fixed_btn_kong"></div>
		<!--content end-->
		<div class="microphone_section ">
			<!--开始说话前-->
			<div class="before_speak" >
				<div class="before_speak_box" >
					<p>按住说话</p>
					<a href="javascript:void(0)" class="iconfont hide_microphone"></a>
					<a href="javascript:void(0)" class="iconfont deal_microphone"></a>
				</div>
			</div>
			<!--开始说话前 end-->
			<!--说话中-->
			<div class="speaking" style="display: none;">
				<div class="speaking_box">
					<p>请说话</p>
					<div class="deal_shadow" >
						<a href="javascript:void(0)" class="iconfont deal_microphone"></a>
					</div>
				</div>
			</div>
			<!--说话中 end-->
			<!--说话完成后，待确认-->
			<div class="ensure_speak" style="display: none;">
				<div class="ensure_box">
					<div class="speaking_result">这里是语音转换成文字后的区域</div>
					<a href="javascript:void(0)" class="word_deal result_cancle">取消</a>
					<a href="javascript:void(0)" class="iconfont deal_microphone"></a>
					<a href="javascript：void(0)" class="word_deal result_ensure">确定</a>
				</div>
				
			</div>
			<!--说话完成后，待确认 end-->
		</div>
		<div class="microphone_section_kong"></div>
	</body>
	<script type="text/javascript">
	var memcardno;//会员卡号
	var compid;//企业编码
	var entityname;
	var fileno;
	var wareid;
	var warecode;
	var warename;
	var warespec;
	var notes;
	var factoryname;
	//接收页面传过来的会员号
    function UrlSearch(){
       var name,value; 
       var str=location.href;
       var num=str.indexOf("?");
       str=str.substr(num+1);
       var arr=str.split("&");
       for(var i=0;i < arr.length;i++){ 
         num=arr[i].indexOf("="); 
          if(num>0){ 
          name=arr[i].substring(0,num);
          value=arr[i].substr(num+1);
          this[name]=value;
         } 
       } 
     } 
	
    var LocString=String(window.document.location.href);
    function GetQueryString(str){
    var rs=new RegExp("(^|)"+str+"=([^&]*)(&|$)","gi").exec(LocString),tmp;
    if(tmp=rs)return tmp[2];
    return " ";
    }
	
    var Request=new UrlSearch(); 
    memcardno=Request.memcardno;
    compid=Request.compid;
    fileno=Request.fileno;
	
    
    wareid=decodeURI(GetQueryString("wareid"));
    warecode=decodeURI(GetQueryString("warecode"));
    warename=decodeURI(GetQueryString("warename"));
    warespec=decodeURI(GetQueryString("warespec"));
    notes=decodeURI(GetQueryString("notes"));
    factoryname=decodeURI(GetQueryString("factoryname"));
    $("#warecode").val(warecode);
	$("#warename").val(warename);
	$('#usage').val(notes);
	$('#warespec').val(warespec);
	$('#factoryname').val(factoryname);
    alert(wareid+"=="+warecode+"=="+warename+"=="+usage+"=="+warespec);
	
		$(function(){
			//语音输入
			$('.microphone_input').click(function(){
				$(".microphone_section").toggleClass('animate')
			});
			$('a.hide_microphone').click(function(){
				$(".microphone_section").removeClass('animate');
			})
			
			//病种选择
			$('.illness_name').click(function(){
				$.ajax({
					url:"getEntity.do?compid="+compid,
					type:"get",
					dataType:"json",
					success:function(data){
						 var json = eval(data);
   				  		 var list=[];
   				  	     $("#show1").append('<div class="section_title">病种选择</div>'+
							'<div class="list_box disease_box">'+
							'<div class="father_list_box">'+
							'<form>'+
							'<ul class="father_list" id="father_list1">'+
							'</ul>'+
							'</form>'+
							'</div>'+
							'<div>'+
							'<ul class="child_list" id="child_list1">'+
							'<li >糖尿病I型</li>'+
							'<li >糖尿病II型</li>'+
							'<li >妊娠糖尿病</li>'+
							'<li >继发性糖尿病</li>'+
							'</ul>'+
						'</div>'+
						'<button class="next_step_btn" onclick="next1()">下一步</button>'+
						'</div>'
    	    			);
   				  	     var tag=0;
     					 $(json).each(function(i){
	        				list[i]=json[i];
	        				$("#father_list1").append('<li onclick="clickEntity()" val="f'+tag+'">'+list[i].ENTITYNAME+'</li>');
						    tag++;
     					 });
     					alertShow('alert_illness_category');
						position();
						//子病种选择()
						
						$('ul.child_list li,ul.father_list li').click(function(){
							$(this).addClass('on').siblings().removeClass('on')
						});
						//病种选择的下一步
						$('.alert_illness_category .next_step_btn').click(function(){
							var child_list = $('.alert_illness_category ul.child_list li.on').html();
							var father_list = $('.alert_illness_category ul.father_list li.on').html();
							if( ( father_list != undefined ) && (child_list != undefined )  ){
								$("#illness_name").children('input').val( father_list );
								$("#illness_category").children('input').val( child_list );
								alertShow('alert_illness_basic');
							}
						});
						
					  }
					});
				
				});
			
			//病症选择
			$(".illness_category").click(function(){
				var ill_name = $("#illness_name").children('input').val();
				if( ill_name == "" ){
					alertShow('alert_notice');
					position();
					setInterval(function(){
						close()
					},1500)
				}else{
					alertShow('alert_illness_category');
					position();
				}
			})
			
			//治疗状态的选择
			$('.illness_statue').click(function(){
				var ill_name = $("#illness_name").children('input').val();
				if( ill_name == "" ){
					alertShow('alert_notice');
					position();
					setInterval(function(){
						close()
					},1500);
				}else{
					alertShow('alert_illness_statue')
					position();
				}
			})
			
			//选择治疗状态
			$('.alert_illness_statue ul.condition_list li').click(function(){
				$(this).addClass('on').siblings().removeClass('on')
			})
			
			$('.alert_illness_statue button.save').click(function(){
				var state = $('.alert_illness_statue ul.condition_list li.on').html();
				if( state != undefined ){
					$('#illness_statue').html( state )
					 close();
				}
			})
			
			
			//修改信息
			var temp = '';
			$('.info_input').click(function(){
				$(this).children('input.form_control').show().focus().siblings('.input_result').hide();
				temp = $(this).children('.input_result').html();
			});
			$('input.form_control').blur(function(){
				var $this = $(this);
				var result = $this.val();
				if(  ( result == '' ) && ( temp == '' )  ) {
					result = '未填写';
				}else if( ( result == '' ) && ( temp != '' ) ){
					result = temp;
				}
				$(this).hide().siblings('.input_result').html( result ).show()
			});
			//性别选择
			$('.user_sex').click(function(){
				layer.open({
					content : `
							  <div class="select_section">
							  		<ul class="select_options">
							  			<li val="0">男</li>
							  			<li val="1">女</li>
							  		</ul>
							  </div>
					        `
				});
				select( 'user_sex' ) ;
			})
			//家庭身份选择
			$('.family_identity').click(function(){
				layer.open({
					content : `
							  <div class="select_section">
							  		<ul class="select_options">
							  			<li val="0">本人</li>
							  			<li val="1">配偶</li>
							  			<li val="2">父亲</li>
							  			<li val="3">母亲</li>
							  		</ul>
							  </div>
					        `
				});
				select( 'family_identity' ) ;
				
			});
			
			//医保信息
			$('.safeguard_info').click(function(){
				layer.open({
					content : `
							  <div class="select_section">
							  		<ul class="select_options">
							  			<li val="0">市医保</li>
							  			<li val="1">省医保</li>
							  			<li val="2">无医保</li>
							  		</ul>
							  </div>
					          `
				});
				select( 'safeguard_info' ) ;  
			});
			
			//档案类型选择
			$('.archives_sort').click(function(){
				layer.open({
					content : `
							  <div class="select_section">
							  		<ul class="select_options">
							  			<li val="0">普通</li>
							  			<li val="1">慢病</li>
							  		</ul>
							  </div>
					          `
				});
				select( 'archives_sort' ) ;
			});
			
			function select(target){
				$('ul.select_options li').click(function(){
					var $this = $(this);
					var html = $this.html();
					var val = $this.attr('val');
					$('.'+target ).html( html ).attr('val' ,val);
					layer.closeAll()
				})
			}

			
			
		})
		
		//多选保存选项
		function selectMore(name){
			var options = [];
			if( options[0] != undefined ){}
				$('ul.'+name+'_list li.on').each(function(){
					options.push( $(this).html() );
				})
				var $UL ='';
				if( options[0] != undefined ){
					var $LI = '';
					for( var i = 0 ; i < options.length ; i++ ){
						$LI += '<li>'+options[i]+'</li>';
					}
					$UL = '<ul class="illness_label">'+$LI+'</ul>';
				}
			return $UL ;
		}
		
		
		  function clickEntity(){
				var obj_lis = document.getElementById("father_list1").getElementsByTagName("li");
			    for(i=0;i<obj_lis.length;i++){
			    	 obj_lis[i].onclick = function(){
			             entityname=this.innerHTML;
			             $.ajax({
			 				url:"getEntityType.do?entityname="+entityname+"&compid="+compid,
			 				type:"get",
			 				dataType:"json",
			 				success:function(data){
			 					 $('#child_list1 li').each(function(){     
			 				        $(this).remove();  
			 				     }); 
			 					 var json = eval(data);
		   				  		 var list=[];
		     					 $(json).each(function(i){
			        				list[i]=json[i];
			        				//alert(list[i].TYPENAME); 
			        				$("#child_list1").append('<li>'+list[i].TYPENAME+'</li>');
		     					 });
		     					$('ul.child_list li,ul.father_list li').click(function(){
									$(this).addClass('on').siblings().removeClass('on')
								});
			 				}
			 		   });  
			         }
			    }
		   }
		   
		   function next1(){
			   $.ajax({
					url:"getEntitySymptom.do?entityname="+entityname+"&compid="+compid,
					type:"get",
					dataType:"json",
					success:function(data){
						$('#symptoms_list1 li').each(function(){     
	 				        $(this).remove();  
	 				     }); 
						 var json = eval(data);
					     var list=[];
					     $("#show2").append('<div class="section_title">基本病症选择</div>'+
							'<div class="list_box symptoms_box">'+
								'<ul class="symptoms_list" id="symptoms_list1">'+
								'</ul>'+
								'<div class="btn_set">'+
									'<button class="pre_step_btn">上一步</buttom>'+
									'<button class="next_step_btn" onclick="next2()">下一步</buttom>'+
								'</div>'+
							'</div>');
						 $(json).each(function(i){
	       				  list[i]=json[i];
	       				  $("#symptoms_list1").append('<li>'+list[i].SYMPTOM+'</li>');
						 });
						
				//基本病症选择
				$('.illness_basic').click(function(){
					var ill_name = $("#illness_name").children('input').val();
						if( ill_name == "" ){
							alertShow('alert_notice');
							position();
							setInterval(function(){
							 close()
							},1500);
						}else{
							alertShow('alert_illness_basic');
							position();
					}
				})
						 
				//基本病症选择
				//上一步
				$('.alert_illness_basic button.pre_step_btn').click(function(){
						alertShow('alert_illness_category');
						position();
				});
				//下一步
				$('.alert_illness_basic button.next_step_btn').click(function(){
						var result = selectMore( 'symptoms' );
						$('#illness_basic').html( result );
						alertShow('alert_illness_link')
						position();
				});
				//病症选择()
				$('ul.symptoms_list li').click(function(){
						$(this).toggleClass('on')
				});
			    }
			   });  
		  	 }
		   
		   function next2(){
			   $.ajax({
					url:"getEntitySyndrome.do?entityname="+entityname+"&compid="+compid,
					type:"get",
					dataType:"json",
					success:function(data){
						$('#complications_list1 li').each(function(){     
	 				        $(this).remove();  
	 				     });
						 var json = eval(data);
					     var list=[];
					     $("#show3").append('<div class="section_title">并发症选择</div>'+
					 			'<div class="complications">'+
								'<ul class="complications_list" id="complications_list1">'+
								'</ul>'+
								'<div class="btn_set">'+
									'<button class="pre_step_btn" style="background: #ccc;">上一步</button>'+
									'<button class="save_btn">保存</button>'+
								'</div>'+
							'</div>');
						 $(json).each(function(i){
	      					  list[i]=json[i];
	      					  $("#complications_list1").append('<li>'+list[i].SYNDROME+'</li>');
						 });
						 position()
						//并发症选择
						$('.illness_link').click(function(){
							var ill_name = $("#illness_name").children('input').val();
							if( ill_name == "" ){
								alertShow('alert_notice');
								position();
								setInterval(function(){
									close()
								},1500)
							}else{
								alertShow('alert_illness_link')
								position();
							}
						});
						
						//并发症选择
						//上一步
						$('.alert_illness_link button.pre_step_btn').click(function(){
							alertShow('alert_illness_basic');
							position();
						});
						//并发症选择
						$("ul.complications_list li").click(function(){
							$(this).toggleClass('on')
						});
						
						//保存按钮
						$('.alert_illness_link .btn_set .save_btn').click(function(){
							var complications = [];
							$('ul.complications_list li.on').each(function(){
								complications.push( $(this).html() );
							})
							var $UL ='';
							if( complications[0] != undefined ){
								var $LI = '';
								for( var i = 0 ; i < complications.length ; i++ ){
									$LI += '<li>'+complications[i]+'</li>';
								}
								$UL = '<ul class="illness_label">'+$LI+'</ul>';
							}else{
								$UL = '无';
							}
							$("#illness_link").html($UL);
							close();
						})
					}
		   		  });  
		   		}
		
	function saveMembers(){
			   //var MEMCARDNO=$("#MEMCARDNO").val();
			   var CARDHOLDER=$("#CARDHOLDER").val();
			   var SEX=$("#SEX").html();
			   var IDCARD=$('#IDCARD').val();
			   var FAMILY=$('#FAMILY').html();
			   var MODBUSNO=$('#MODBUSNO').html();
			   var MEDICAL=$("#MEDICAL").html();
			   var FILETYPE=$("#FILETYPE").html();
			   var BILLNO=$("#BILLNO").html();
			   var MOBILE=$("#MOBILE").val();	
			   var EMECONTACT=$("#EMECONTACT").val();
			   var TEL=$("#TEL").val();
			   var HEIGHT=$("#HEIGHT").val();
			   var WEIGHT=$('#WEIGHT').val();
			   var TEMPERATURE=$('#TEMPERATURE').val();
			   var STEPS=$('#STEPS').val();
			   var OXYGEN=$("#OXYGEN").val();
			   var SYSTOLIC=$("#SYSTOLIC").val();
			   var DIASTOLIC=$("#DIASTOLIC").val();
			   var HEARTRATE=$("#HEARTRATE").val();	
			   var BLOODSUGAR1=$("#BLOODSUGAR1").val();
			   var BLOODSUGAR2=$("#BLOODSUGAR2").val();
			   var BLOODSUGAR3=$("#BLOODSUGAR3").val();
			   var BLOODSUGAR4=$('#BLOODSUGAR4').val();
			   var BLOODSUGAR5=$('#BLOODSUGAR5').val();
			   var BLOODSUGAR6=$('#BLOODSUGAR6').val();
			   var BLOODSUGAR7=$("#BLOODSUGAR7").val();
			   var BLOODSUGAR8=$("#BLOODSUGAR8").val();
			   var GLYCOSYLATED=$("#GLYCOSYLATED").val();
			   var CHOLESTEROL=$("#CHOLESTEROL").val();	
			   var TRIGLYCERIDE=$("#TRIGLYCERIDE").val();
			   var HIGHLIPOPROTEIN=$("#HIGHLIPOPROTEIN").val();
			   var LOWLIPOPROTEIN=$("#LOWLIPOPROTEIN").val();
			   var HOMOCYSTEINE=$('#HOMOCYSTEINE').val();
			   
			   var diseasename=$("#diseasename").val();
			   var diseasetype=$("#diseasetype").val();
			  // var shootingtime=$("input[type=button]").val();
			   var treatmentstate=$('.alert_illness_statue ul.condition_list li.on').html();
			   var symptom=$('.alert_illness_basic ul.symptoms_list li.on').html();
			   var concurrent=$('.alert_illness_link ul.complications_list li.on').html();
			   var pathogeny=$("#pathogeny").val();

			   //var warecode=$("#warecode").val();
			   //var warename=$("#warename").val();
			   //var factoryname=$("#factoryname").val();
			   //var usage=$('#usage').val();
			   //var warespec=$('#warespec').val();
			   var availabledays=$('#availabledays').val();
			   var stilluse=$("#stilluse").val();
			   var startTime=$("#datePicker1").val();
			   var endTime=$("#datePicker2").val();
			   var notes=$("#notes").val();
			   
			   $.ajax({
					url:"addMembers.do?memcardno="+memcardno+"&compid="+compid+"&CARDHOLDER="+CARDHOLDER+"&SEX="+SEX+"&IDCARD="+IDCARD+"&FAMILY="+FAMILY+"&MODBUSNO="+MODBUSNO+"&MEDICAL="+MEDICAL+"&FILETYPE="+FILETYPE+"&MOBILE="+MOBILE+"&EMECONTACT="+EMECONTACT+"&TEL="+TEL+"&HEIGHT="+HEIGHT+"&WEIGHT="+WEIGHT+"&TEMPERATURE="+TEMPERATURE+"&STEPS="+STEPS+"&OXYGEN="+OXYGEN+"&SYSTOLIC="+SYSTOLIC+"&DIASTOLIC="+DIASTOLIC+"&HEARTRATE="+HEARTRATE+"&BLOODSUGAR1="+BLOODSUGAR1+"&BLOODSUGAR2="+BLOODSUGAR2+"&BLOODSUGAR3="+BLOODSUGAR3+"&BLOODSUGAR4="+BLOODSUGAR4+"&BLOODSUGAR5="+BLOODSUGAR5+"&BLOODSUGAR6="+BLOODSUGAR6+"&BLOODSUGAR7="+BLOODSUGAR7+"&BLOODSUGAR8="+BLOODSUGAR8+"&GLYCOSYLATED="+GLYCOSYLATED+"&CHOLESTEROL="+CHOLESTEROL+"&TRIGLYCERIDE="+TRIGLYCERIDE+"&HIGHLIPOPROTEIN="+HIGHLIPOPROTEIN+"&LOWLIPOPROTEIN="+LOWLIPOPROTEIN+"&HOMOCYSTEINE="+HOMOCYSTEINE,
					type:"get",
					dataType:"json",
					success:function(data){
						location.href="member-relationship.html?memcardno="+memcardno+"&compid="+compid;
					}
		       });
			   
			   
	}
	
	 function clickSearch(){
    	 location.href="medicine-searching-members.html?memcardno="+memcardno+"&compid="+compid;
     }
	 
	 
	
	</script>
</html>
